metadata:
  id: pvtr-scan-001
  description: "Baseline scan of pvtr repository against OSPS controls"
  author:
    id: pvtr-github-repo
    name: pvtr-github-repo
    type: Software
    version: "1.0.0"
    uri: "https://github.com/revanite-io/pvtr-github-repo"

evaluations:
  - name: "Access Control - MFA"
    control:
      reference-id: OSPS
      entry-id: OSPS-AC-01
    result: Passed
    message: Two-factor authentication is configured as required by the parent organization
    assessment-logs:
      - requirement:
          reference-id: OSPS
          entry-id: OSPS-AC-01.01
        applicability:
          - Maturity Level 1
          - Maturity Level 2
          - Maturity Level 3
        description: |
          When a user attempts to access a sensitive resource in the project's
          version control system, the system MUST require the user to complete
          a multi-factor authentication process.
        result: Passed
        message: Two-factor authentication is configured as required by the parent organization
        steps:
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/osps/access_control.orgRequiresMFA"
        steps-executed: 1
        start: "2025-08-22T16:02:00Z"
        end: "2025-08-22T16:02:00Z"

  - name: "Access Control - Least Privilege"
    control:
      reference-id: OSPS
      entry-id: OSPS-AC-02
    result: Passed
    message: This control is enforced by GitHub for all projects
    assessment-logs:
      - requirement:
          reference-id: OSPS
          entry-id: OSPS-AC-02.01
        applicability:
          - Maturity Level 1
          - Maturity Level 2
          - Maturity Level 3
        description: |
          When a new collaborator is added, the version control system MUST
          require manual permission assignment, or restrict the collaborator
          permissions to the lowest available privileges by default.
        result: Passed
        message: This control is enforced by GitHub for all projects
        steps:
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.GithubBuiltIn"
        steps-executed: 1
        start: "2025-08-22T16:02:00Z"
        end: "2025-08-22T16:02:00Z"

  - name: "Access Control - Branch Protection"
    control:
      reference-id: OSPS
      entry-id: OSPS-AC-03
    result: Passed
    message: Branch protection rule prevents deletions
    assessment-logs:
      - requirement:
          reference-id: OSPS
          entry-id: OSPS-AC-03.01
        applicability:
          - Maturity Level 1
          - Maturity Level 2
          - Maturity Level 3
        description: |
          When a direct commit is attempted on the project's primary branch,
          an enforcement mechanism MUST prevent the change from being applied.
        result: Passed
        message: Branch protection rule requires approving reviews
        steps:
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.IsCodeRepo"
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/osps/access_control.branchProtectionRestrictsPushes"
        steps-executed: 2
        start: "2025-08-22T16:02:00Z"
        end: "2025-08-22T16:02:00Z"
      - requirement:
          reference-id: OSPS
          entry-id: OSPS-AC-03.02
        applicability:
          - Maturity Level 1
          - Maturity Level 2
          - Maturity Level 3
        description: |
          When an attempt is made to delete the project's primary branch,
          the version control system MUST treat this as a sensitive activity
          and require explicit confirmation of intent.
        result: Passed
        message: Branch protection rule prevents deletions
        steps:
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/osps/access_control.branchProtectionPreventsDeletion"
        steps-executed: 1
        start: "2025-08-22T16:02:00Z"
        end: "2025-08-22T16:02:00Z"

  - name: "Documentation - User Guides"
    control:
      reference-id: OSPS
      entry-id: OSPS-DO-01
    result: Failed
    message: User guide was NOT specified in Security Insights data
    assessment-logs:
      - requirement:
          reference-id: OSPS
          entry-id: OSPS-DO-01.01
        applicability:
          - Maturity Level 1
          - Maturity Level 2
          - Maturity Level 3
        description: |
          When the project has made a release, the project documentation MUST
          include user guides for all basic functionality.
        result: Failed
        message: User guide was NOT specified in Security Insights data
        steps:
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.HasMadeReleases"
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.HasSecurityInsightsFile"
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/osps/docs.hasUserGuides"
        steps-executed: 3
        start: "2025-08-22T16:02:00Z"

  - name: "Vulnerability Management - Security Contacts"
    control:
      reference-id: OSPS
      entry-id: OSPS-VM-02
    result: Failed
    message: Security contacts were not specified in Security Insights data
    assessment-logs:
      - requirement:
          reference-id: OSPS
          entry-id: OSPS-VM-02.01
        applicability:
          - Maturity Level 1
        description: |
          While active, the project documentation MUST contain
          security contacts.
        result: Failed
        message: Security contacts were not specified in Security Insights data
        steps:
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/reusable_steps.IsCodeRepo"
          - "github.com/revanite-io/pvtr-github-repo/evaluation_plans/osps/vuln_management.hasSecContact"
        steps-executed: 2
        start: "2025-08-22T16:02:00Z"
